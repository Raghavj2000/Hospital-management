<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hospital Management System</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../static/css/style.css">
</head>
<body>
    <div id="app">
        <!-- Main App Container -->
        <div v-if="!isAuthenticated">
            <!-- Authentication Views -->
          <auth-component @login-success="handleLoginSuccess"></auth-component>
        </div>

        <div v-else>
            <!-- Navbar -->
            <navbar-component
                :user="currentUser"
                @logout="handleLogout">
            </navbar-component>

            <!-- Main Content -->
            <div class="container-fluid">
                <div class="row">
                    <!-- Admin Dashboard -->
                    <admin-dashboard v-if="currentUser.role === 'admin'"></admin-dashboard>

                    <!-- Doctor Dashboard -->
                    <doctor-dashboard v-else-if="currentUser.role === 'doctor'"></doctor-dashboard>

                    <!-- Patient Dashboard -->
                    <patient-dashboard v-else-if="currentUser.role === 'patient'"></patient-dashboard>
                </div>
            </div>
        </div>

        <!-- Loading Overlay -->
        <div v-if="loading" class="loading-overlay">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>

        <!-- Toast Notifications -->
        <div class="toast-container position-fixed top-0 end-0 p-3">
            <div v-for="(toast, index) in toasts" :key="index"
                 class="toast show" role="alert">
                <div class="toast-header" :class="toast.type === 'error' ? 'bg-danger text-white' : 'bg-success text-white'">
                    <strong class="me-auto">
                        <i :class="toast.type === 'error' ? 'bi bi-exclamation-triangle' : 'bi bi-check-circle'"></i>
                        {{ toast.type === 'error' ? 'Error' : 'Success' }}
                    </strong>
                    <button type="button" class="btn-close btn-close-white" @click="removeToast(index)"></button>
                </div>
                <div class="toast-body">
                    {{ toast.message }}
                </div>
            </div>
        </div>
    </div>

    <!-- Vue.js 3 CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Axios for API calls -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- API Service -->
    <script src="../static/js/api.js"></script>

    <!-- Components -->
    <script src="../components/AuthComponent.js"></script>
    <script src="../components/NavbarComponent.js"></script>
    <script src="../components/AdminDashboard.js"></script>
    <script src="../components/DoctorDashboard.js"></script>
    <script src="../components/PatientDashboard.js"></script>

    <!-- Main App -->
    <script src="../static/js/app.js"></script>
</body>
</html>
